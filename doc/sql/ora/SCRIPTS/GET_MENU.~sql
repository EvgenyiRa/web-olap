SELECT RCV.ID,
       RCV.NUM_ORDER,
       RCV.N_VALUE,
       RCV.S_VALUE,
       CASE WHEN (SELECT COUNT(1)       
                    FROM REP_CATEGORY_VALUE RCV2
                    JOIN REP_CATEGORY_TYPE RCT2
                      ON RCT2.ID=RCV2.CAT_ID 
                    WHERE RCT2.SYSNAME='menu'
                      AND NVL(RCV2.PARENT_CAT_ID,-1)=RCV.ID
                  )=0 THEN 0
            ELSE 1
       END IS_TREE,
       RCL.OBJ_ID FORM_ID,
       RD.NAME FORM_NAME,
       RD.SYSNAME FORM_SNAME     
FROM REP_CATEGORY_VALUE RCV
JOIN REP_CATEGORY_TYPE RCT
  ON RCT.ID=RCV.CAT_ID 
LEFT JOIN REP_CATEGORY_LINKS  RCL
  ON RCL.CAT_ID=RCV.ID
LEFT JOIN REP_DATA RD
  ON RD.ID=RCL.OBJ_ID  
WHERE RCT.SYSNAME='menu'
  AND COALESCE(RCV.PARENT_CAT_ID,-1)=-1
ORDER BY RCV.NUM_ORDER
